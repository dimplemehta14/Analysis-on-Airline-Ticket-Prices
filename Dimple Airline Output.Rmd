---

  word_document: default
  html_notebook: default
---

# Analysis of Airline Ticket Pricing
# NAME: Dimple Mehta
# EMAIL: dimplemehta016@gmail.com
# COLLEGE / COMPANY: School of Engineering and Technology, Jain University


```{r}
#Read data into R
SixAirline <- read.csv(paste("SixAirlinesDataV2.csv", sep="")) 
View(SixAirline)
```

```{r}
#Summarize the data to understand the mean, median, standard deviation of  each variable
summary(SixAirline)
```

```{r}
#Draw Box Plots to visualize the distribution of Price of Economy tickets in different Airlines
boxplot(SixAirline$PriceEconomy ~ SixAirline$Airline,
        data=SixAirline, 
        horizontal=TRUE, 
        yaxt="n", 
        ylab="Airline",
        xlab="PriceEconomy", 
        main="Comparison of Price in different Airlines")
axis(side=2, at=c(1,2,3,4,5,6), 
     labels=c("AirFrance", "British "," Delta","Jet","Singapore","Virgin"))

```

```{r}
#Draw Box Plots to visualize the distribution of Price of Premium tickets in different Airlines
boxplot(SixAirline$PricePremium ~ SixAirline$Airline,
        data=SixAirline, 
        horizontal=TRUE, 
        yaxt="n", 
        ylab="Airline",
        xlab="PricePremium", 
        main="Comparison of Price in different Airlines")
axis(side=2, at=c(1,2,3,4,5,6), 
     labels=c("AirFrance", "British "," Delta","Jet","Singapore","Virgin"))

```


```{r}
#Draw Bar Plots to visualize the distribution of Pitch size in different Airlines
#Pitch size in Economy class
seate.mean <- aggregate(PitchEconomy ~ Airline, data=SixAirline, mean)
#Pitch size in Premium class
seatp.mean <- aggregate(PitchPremium ~ Airline, data=SixAirline, mean)
```
```{r}
#Visualizing them
library(lattice)
barchart(PitchEconomy ~ Airline, data=seate.mean, col="grey")
barchart(PitchPremium ~ Airline, data=seatp.mean, col="grey")

```


```{r}
#To visualize the distribution of Width size in different Airlines
#Width size in Economy class
widthe.mean <- aggregate(WidthEconomy ~ Airline, data=SixAirline, mean)
#Width size in Premium class
widthp.mean <- aggregate(WidthPremium ~ Airline, data=SixAirline, mean)
```

```{r}
#visualizing them
barchart(WidthEconomy ~ Airline, data=widthe.mean, col="grey")
barchart(WidthPremium ~ Airline, data=widthp.mean, col="grey")

```


```{r}
#Making scatter plot matrix to see the coorelation between different variables
scatterplotMatrix( SixAirline[ ,c("PitchPremium","PitchEconomy")], 
                   spread=FALSE, 
                   smoother.args=list(lty=2), 
                   main="Scatter Plot Matrix")

scatterplotMatrix( SixAirline[ ,c("WidthPremium","WidthEconomy")], 
                   spread=FALSE, 
                   smoother.args=list(lty=2), 
                   main="Scatter Plot Matrix")
scatterplotMatrix( SixAirline[ ,c("PriceEconomy","PricePremium")], 
                   spread=FALSE, 
                   smoother.args=list(lty=2), 
                   main="Scatter Plot Matrix")
scatterplotMatrix( SixAirline[ ,c("SeatsPremium","SeatsEconomy")], 
                   spread=FALSE, 
                   smoother.args=list(lty=2), 
                   main="Scatter Plot Matrix")
scatterplotMatrix( SixAirline[ ,c("PitchDifference","WidthDifference")], 
                   spread=FALSE, 
                   smoother.args=list(lty=2), 
                   main="Scatter Plot Matrix")


```

```{r}
#To make Scatter Plots to understand how are the variables correlated pair-wise
#Correlation between Price of Premium Ticket and Pitch Difference
library(car)
scatterplot(PricePremium ~ PitchDifference, data=Airline,
            spread=FALSE, smoother.args=list(lty=2), pch=19,
            main="Scatterplot of Pitch Diff",
            xlab="PitchDifference",
            ylab="PricePremium")

```


```{r}
#Correlation between Price of Economy Ticket and Pitch Difference
scatterplot(PriceEconomy ~ PitchDifference, data=Airline,
            spread=FALSE, smoother.args=list(lty=2), pch=19,
            main="Scatterplot of Pitch Diff",
            xlab="PitchDifference",
            ylab="PriceEconomy")
```

```{r}
#Correlation between Price of Economy Ticket and Width Difference
scatterplot(PriceEconomy ~ WidthDifference, data=Airline,
            spread=FALSE, smoother.args=list(lty=2), pch=19,
            main="Scatterplot of Width Diff",
            xlab="WidthDifference",
            ylab="PriceEconomy")
```

```{r}
#Correlation between Price of Premium Ticket and Width Difference
scatterplot(PricePremium ~ WidthDifference, data=Airline,
            spread=FALSE, smoother.args=list(lty=2), pch=19,
            main="Scatterplot of Width Diff",
            xlab="WidthDifference",
            ylab="PricePremium")
```

```{r}
#Draw a Corrgram
library(corrgram)
corrgram(SixAirline, order=FALSE, 
         lower.panel=panel.shade,
         upper.panel=panel.pie, 
         diag.panel=panel.minmax,
         text.panel=panel.txt,
         main="Corrgram of Six Airline intercorrelations")
```

```{r}
#Create a Variance-Covariance Matrix
options(digits=2)
cor(SixAirline$PitchPremium, SixAirline$PricePremium)
cor(SixAirline$WidthPremium, SixAirline$PricePremium)
cor(SixAirline$PitchEconomy, SixAirline$PriceEconomy)
cor(SixAirline$WidthEconomy, SixAirline$PriceEconomy)

```


```{r}
#Perform a Pearson Test for coorelation
resP <- cor.test(SixAirline$WidthPremium, SixAirline$PricePremium, 
                    method = "pearson")
resP
```

```{r}
#Perform a Pearson Test for coorelation
resE <- cor.test(SixAirline$WidthEconomy, SixAirline$PriceEconomy, 
                    method = "pearson")
resE
```

```{r}
#Articulate a Hypothesis (or two) that you could test using a Regression Model
#1.NULL HYPOTHESIS: Increase in PitchPremium does not contribute in increase in PricePremium
#2.NULL HYPOTHESIS: Increase in WidthPremium does not contribute in increase in Price Premium
```

```{r}
#Run T-Tests to test the first hypothesis
t.test(SixAirline$PitchPremium, SixAirline$PricePremium)
```

```{r}
#Run T-Tests to test the second hypothesis
t.test(SixAirline$WidthPremium, SixAirline$PricePremium)
```

```{r}
#Formulate a Regression Model
m2 <- lm(PricePremium ~ 
           PitchPremium + 
           WidthPremium,
         data=SixAirline)
summary(m2)
```

```{r}

#According to the result, this is made clear that increase in Pitch size and Width size are the major factors contributing to increase in price of Premium ticket.

```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).
